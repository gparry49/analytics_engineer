version: 2

models:
  - name: stg_stackoverflow_posts
    description: A staging table of SO post with selected columns and posts with 0 answers
    columns:
      - name: id
        description: Primary Key for posts table (tested in source tables)
        tests:
          - unique
          - not_null
      - name: post_title
        description: The title of the post
      - name: answer_count
        description: Number of answers to the post
        tests:
          - accepted_values:
              values:
                - 0
              quote: false
      - name: comment_count
        description: Number of comments on the post
      - name: creation_date
        description: The date the post was created
        tests:
          - not_null
      - name: favorite_count
        description: The number of favourites on the post
      - name: owner_user_id
        description: The user ID of the post owner
      - name: score
        description: The score of the post
      - name: tags
        description: The tags selected on the post
      - name: view_count
        description: The number of views on the post

  - name: stg_stackoverflow_posts_unnested
    description: Creates a copy of stg_stackoverflow_posts with a column unnested/exploded to add have a row for each tag
    columns:
      - name: id_surrogate_key
        description: surrogate key for unnested view
      - name: array_tags
        description: An array of tage generated using SPLIT from the tags column
      - name: single_tag
        description: A single tage created using the UNNEST function